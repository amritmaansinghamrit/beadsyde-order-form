<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beadsyde - Order Your Infinity Essentials</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Daydream&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZEEWPYS2LD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZEEWPYS2LD');

        // Debug Google Analytics
        console.log('üîç Google Analytics initialized with ID: G-ZEEWPYS2LD');
    </script>

    <!-- Firebase for Real-time Database -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getDatabase, ref, push, set, onValue } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js';

        // Firebase configuration - Your actual config
        const firebaseConfig = {
            apiKey: "AIzaSyAruBAoy7ND1n6TyPGu0wlfZYc1czWRcfA",
            authDomain: "beadsyde-rashi.firebaseapp.com",
            databaseURL: "https://beadsyde-rashi-default-rtdb.firebaseio.com",
            projectId: "beadsyde-rashi",
            storageBucket: "beadsyde-rashi.firebasestorage.app",
            messagingSenderId: "577212292475",
            appId: "1:577212292475:web:eb53d288cb99d6937b31de",
            measurementId: "G-ZEEWPYS2LD"
        };

        // Initialize Firebase
        let app, database;
        try {
            app = initializeApp(firebaseConfig);
            database = getDatabase(app);
            window.firebaseDB = database;
            console.log('üî• Firebase initialized successfully');
        } catch (error) {
            console.warn('üî• Firebase initialization failed, using local storage fallback:', error);
            window.firebaseDB = null;
        }
    </script>

    <!-- Comprehensive Analytics Tracking -->
    <script defer src="https://cdn.vercel-insights.com/v1/script.debug.js"></script>
    <style>
        :root {
            --primary-blue: #2E5BBA;
            --neutral-beige: #F5F1E8;
            --pure-white: #FFFFFF;
            --text-dark: #1a1a1a;
            --text-medium: #4a4a4a;
            --text-light: #888;
            --border-light: #e1e1e1;
            --border-focus: #2E5BBA;
            --success-green: #10B981;
            --error-red: #EF4444;
            --shadow-subtle: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-soft: 0 4px 12px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            --border-radius-large: 12px;
            --transition: all 0.2s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--neutral-beige);
            color: var(--text-dark);
            line-height: 1.5;
            padding: 20px 20px 50px 20px;
            font-weight: 400;
            position: relative;
            min-height: 100vh;
        }

        /* Full-page background with light blur and tint */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('images/beadsyde background.jpg') repeat;
            background-size: 500px 500px;
            background-position: 0 0;
            filter: blur(0.8px);
            opacity: 0.22;
            z-index: -2;
            image-rendering: optimizeQuality;
            image-rendering: -webkit-optimize-contrast;
            background-attachment: fixed;
        }

        /* Light blue tint overlay */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(46, 91, 186, 0.03), rgba(176, 196, 255, 0.04));
            z-index: -1;
        }

        .container {
            max-width: 900px;
            margin: 0 auto 50px auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border-radius: var(--border-radius-large);
            box-shadow: 0 8px 32px rgba(46, 91, 186, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        /* Modern Header */
        .header {
            background: linear-gradient(135deg, var(--pure-white) 0%, #f8faff 100%);
            padding: 12px 40px 10px;
            text-align: center;
            border-bottom: 1px solid var(--border-light);
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), #667eea, var(--primary-blue));
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 14px;
            margin-bottom: 12px;
        }

        .brand-text {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
        }

        .logo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(46, 91, 186, 0.2);
            border: 3px solid var(--pure-white);
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .brand-name {
            font-family: 'Daydream', cursive;
            font-size: 2.8em;
            font-weight: normal;
            color: var(--primary-blue);
            margin: 0;
            letter-spacing: -0.02em;
            text-shadow: 0 2px 4px rgba(46, 91, 186, 0.1);
        }

        .brand-subheading {
            font-size: 1.1em;
            color: var(--text-medium);
            margin: 6px 0 0 0;
            font-weight: 400;
        }

        .infinity-text {
            /* Remove custom font to match parent section-title */
        }

        .tagline {
            font-size: 1.1em;
            color: var(--text-medium);
            font-weight: 400;
            margin-top: 8px;
            font-style: italic;
        }

        .header-decoration {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 8px;
        }

        .decoration-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary-blue);
            opacity: 0.6;
        }

        .decoration-dot.center {
            opacity: 1;
            transform: scale(1.2);
        }

        /* Shopping Cart Icon */
        .cart-icon {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-blue);
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            box-shadow: var(--shadow-hover);
            z-index: 1000;
            transition: var(--transition);
        }

        .cart-icon:hover {
            transform: scale(1.1);
            background: #1e4a9f;
        }

        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--error-red);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: 600;
            min-width: 24px;
        }

        /* Main Content */
        .form-section {
            padding: 25px 40px 40px 40px;
        }

        .section-header {
            margin-bottom: 24px;
            text-align: center;
        }

        .section-title {
            font-size: 1.8em;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
            letter-spacing: -0.01em;
        }

        .section-subtitle {
            color: var(--text-light);
            font-size: 1em;
        }

        /* Product Section */
        .products-container {
            margin-bottom: 50px;
        }

        .product-group {
            margin-bottom: 40px;
        }

        .product-group-title {
            font-size: 1.4em;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 20px;
            text-align: center;
            padding: 16px;
            background: linear-gradient(135deg, #f8faff, #f0f4ff);
            border-radius: var(--border-radius-large);
            border: 1px solid #e1e8ff;
        }

        .product-variants {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
        }

        .product-card {
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius-large);
            padding: 24px;
            background: var(--pure-white);
            transition: var(--transition);
            position: relative;
            text-align: center;
            box-shadow: var(--shadow-subtle);
        }

        .product-card:hover {
            border-color: var(--primary-blue);
            box-shadow: var(--shadow-soft);
            transform: translateY(-4px);
        }

        .product-image-container {
            width: 100%;
            height: 240px;
            border-radius: var(--border-radius);
            overflow: hidden;
            margin-bottom: 20px;
            background: var(--neutral-beige);
            position: relative;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .product-card:hover .product-image {
            transform: scale(1.03);
        }

        .variant-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: var(--primary-blue);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            box-shadow: var(--shadow-subtle);
        }

        .product-info {
            margin-bottom: 24px;
        }

        .product-name {
            font-size: 1.3em;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .product-price {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 8px;
        }

        .product-description {
            font-size: 0.95em;
            color: var(--text-medium);
            margin-bottom: 20px;
        }

        /* Add to Cart Section */
        .cart-controls {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            margin-bottom: 8px;
        }

        .quantity-label {
            font-weight: 500;
            color: var(--text-medium);
            font-size: 0.95em;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius);
            background: white;
            box-shadow: var(--shadow-subtle);
        }

        .qty-btn {
            border: none;
            background: none;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--primary-blue);
            font-weight: 600;
            font-size: 1.1em;
            transition: var(--transition);
        }

        .qty-btn:hover:not(:disabled) {
            background: var(--neutral-beige);
        }

        .qty-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .qty-display {
            width: 50px;
            text-align: center;
            font-weight: 600;
            border: none;
            background: none;
            font-size: 15px;
            color: var(--text-dark);
        }

        /* Brand-aligned Add to Cart Button */
        .add-to-cart-btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow-subtle);
        }

        .add-to-cart-btn:hover {
            background: #1e4a9f;
            transform: translateY(-1px);
            box-shadow: var(--shadow-soft);
        }

        .add-to-cart-btn.added {
            background: var(--success-green);
            animation: pulse 0.3s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .remove-from-cart-btn {
            background: var(--error-red);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9em;
            margin-top: 8px;
        }

        .remove-from-cart-btn:hover {
            background: #dc2626;
        }

        /* Modern Input Styles */
        .customer-details {
            background: var(--neutral-beige);
            margin: 20px 0;
            padding: 40px;
            border-radius: var(--border-radius);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .form-row.full-width {
            grid-template-columns: 1fr;
        }

        .address-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }

        .address-landmark-row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
            font-size: 0.95em;
        }

        .required {
            color: var(--error-red);
        }

        /* Modern Input Fields */
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid transparent;
            border-radius: var(--border-radius-large);
            font-size: 15px;
            font-family: inherit;
            transition: var(--transition);
            background: var(--pure-white);
            box-shadow: var(--shadow-subtle);
            font-weight: 400;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 4px rgba(46, 91, 186, 0.1);
            transform: translateY(-1px);
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: var(--text-light);
            font-weight: 400;
        }

        .form-group.error input,
        .form-group.error textarea {
            border-color: var(--error-red);
            background-color: #fef7f7;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1);
        }

        .form-group.valid input,
        .form-group.valid textarea {
            border-color: var(--success-green);
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }

        .validation-icon {
            position: absolute;
            right: 16px;
            top: 42px;
            display: none;
            font-size: 16px;
        }

        .form-group.valid .validation-icon.success {
            display: block;
            color: var(--success-green);
        }

        .form-group.error .validation-icon.error {
            display: block;
            color: var(--error-red);
        }

        .error-message {
            color: var(--error-red);
            font-size: 0.85em;
            margin-top: 6px;
            display: none;
            font-weight: 500;
        }

        .form-group.error .error-message {
            display: block;
        }

        /* Order Summary */
        .order-summary {
            background: var(--pure-white);
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius-large);
            padding: 28px;
            margin-top: 32px;
            box-shadow: var(--shadow-subtle);
        }

        .summary-header {
            margin-bottom: 24px;
            text-align: center;
        }

        .summary-title {
            font-size: 1.4em;
            font-weight: 600;
            color: var(--text-dark);
        }

        .empty-cart {
            text-align: center;
            padding: 30px 20px;
            color: var(--text-light);
        }

        .empty-cart i {
            font-size: 2.5em;
            margin-bottom: 16px;
            opacity: 0.3;
            color: var(--primary-blue);
        }

        .summary-items {
            margin-bottom: 20px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .item-details {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .item-image {
            width: 50px;
            height: 50px;
            border-radius: var(--border-radius);
            object-fit: cover;
            box-shadow: var(--shadow-subtle);
        }

        .item-info h4 {
            margin: 0;
            font-size: 1em;
            color: var(--text-dark);
            font-weight: 600;
        }

        .item-info p {
            margin: 0;
            font-size: 0.9em;
            color: var(--text-light);
        }

        .item-price {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 1.1em;
        }

        .summary-totals {
            border-top: 2px solid var(--primary-blue);
            padding-top: 20px;
            margin-top: 20px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .total-row.final {
            font-size: 1.4em;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 0;
        }

        /* Submit Button */
        .submit-section {
            text-align: center;
            margin-top: 32px;
        }

        .submit-btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: var(--border-radius-large);
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-family: inherit;
            min-width: 280px;
            box-shadow: var(--shadow-soft);
        }

        .submit-btn:hover:not(:disabled) {
            background: #1e4a9f;
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .submit-btn:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .payment-info-text {
            text-align: center;
            margin: 12px 0 0 0;
            font-size: 0.9em;
            color: var(--text-medium);
            background: #f0f4ff;
            padding: 12px;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-blue);
        }

        /* Delivery Info */
        .delivery-info {
            background: linear-gradient(135deg, #f8faff, #f0f4ff);
            border: 1px solid #e1e8ff;
            border-radius: var(--border-radius-large);
            padding: 24px;
            margin-top: 24px;
            text-align: center;
        }

        .delivery-title {
            color: var(--primary-blue);
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .delivery-details {
            display: flex;
            justify-content: center;
            gap: 32px;
            font-size: 0.95em;
            color: var(--text-medium);
        }

        .delivery-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .delivery-item i {
            color: var(--primary-blue);
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-content {
            background: white;
            padding: 32px;
            border-radius: var(--border-radius-large);
            text-align: center;
            box-shadow: var(--shadow-hover);
            max-width: 280px;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }


        /* Responsive Design */
        @media (max-width: 768px) and (min-width: 481px) {
            .product-variants {
                grid-template-columns: 1fr 1fr;
                gap: 20px;
            }

            .product-card {
                padding: 20px;
            }

            .product-image-container {
                height: 180px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .form-section,
            .customer-details {
                margin: 15px;
                padding: 24px 20px;
                border-radius: var(--border-radius);
            }

            .address-landmark-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .header {
                padding: 30px 20px 25px;
            }

            .brand-name {
                font-size: 2.2em;
            }

            .section-title {
                font-size: 1.5em;
            }

            .product-variants {
                grid-template-columns: 1fr 1fr;
                gap: 16px;
            }

            .form-row,
            .address-grid {
                grid-template-columns: 1fr;
            }

            .delivery-details {
                flex-direction: column;
                gap: 12px;
            }

            .cart-icon {
                width: 50px;
                height: 50px;
                font-size: 1em;
            }

            .cart-badge {
                width: 20px;
                height: 20px;
                font-size: 0.7em;
            }
        }

        @media (max-width: 480px) {
            .product-variants {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .product-card {
                padding: 20px;
                max-width: 280px;
                margin: 0 auto;
            }

            .product-image-container {
                height: 200px;
            }

            .product-name {
                font-size: 1.2em;
                min-height: 2.5em;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .product-price {
                font-size: 1.6em;
            }

            .add-to-cart-btn {
                padding: 14px 20px;
                font-size: 1em;
            }

            .quantity-selector {
                gap: 12px;
            }

            .quantity-label {
                font-size: 0.9em;
            }

            .logo-container {
                flex-direction: column;
                gap: 8px;
            }

            .brand-name {
                font-size: 1.8em;
            }

            .form-group input,
            .form-group textarea {
                padding: 14px 16px;
            }

            .delivery-info {
                text-align: center;
            }

            .delivery-details {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }

            .delivery-item {
                justify-content: center;
                text-align: center;
            }

            .address-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .address-landmark-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .form-row {
                flex-direction: column;
                gap: 15px;
            }
        }

        .footer {
            background: var(--primary-blue);
            color: white;
            text-align: center;
            padding: 6px 10px;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            font-size: 0.85em;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }

        .footer-content {
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .footer-link {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .footer-link:hover {
            color: var(--neutral-beige);
            text-decoration: underline;
        }

        .footer-content p {
            margin: 0;
        }

        /* Mobile footer */
        @media (max-width: 480px) {
            .footer {
                padding: 4px 8px;
                font-size: 0.75em;
            }

            .footer-content {
                flex-direction: column;
                gap: 2px;
                line-height: 1.2;
            }

            .footer-content p {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
            }
        }

        .cart-quantity-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 5px;
        }

        .cart-qty-btn {
            width: 25px;
            height: 25px;
            border: 1px solid var(--border-light);
            background: var(--pure-white);
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-qty-btn:hover {
            background: var(--neutral-beige);
        }

        .cart-qty-display {
            min-width: 20px;
            text-align: center;
            font-weight: 500;
        }

        .remove-item-btn {
            background: none;
            border: none;
            color: var(--error-red);
            font-size: 12px;
            cursor: pointer;
            margin-top: 5px;
        }

        .remove-item-btn:hover {
            text-decoration: underline;
        }

        .item-price-section {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .shipping-prompt {
            background: linear-gradient(135deg, #e8f5e8, #f0f8f0);
            border: 1px solid #10B981;
            border-radius: var(--border-radius);
            padding: 12px;
            margin: 10px 0;
            text-align: center;
            color: #065f46;
            font-weight: 500;
        }

        .state-dropdown-container {
            position: relative;
        }

        .state-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--pure-white);
            border: 1px solid var(--border-light);
            border-top: none;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .state-dropdown.show {
            display: block;
        }

        .state-option {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f5f5f5;
            transition: var(--transition);
        }

        .state-option:hover {
            background: var(--neutral-beige);
        }

        .state-option:last-child {
            border-bottom: none;
        }

        /* Character counter styles */
        .character-counter {
            text-align: right;
            margin-top: 8px;
            font-size: 0.85em;
            color: var(--text-light);
            font-weight: 500;
        }

        .character-counter.warning {
            color: #f59e0b;
        }

        .character-counter.limit {
            color: var(--error-red);
        }

        .subtitle {
            font-size: 0.85em;
            color: var(--text-light);
            font-weight: 400;
            font-style: italic;
        }
    </style>
</head>
<body>
    <!-- Shopping Cart Icon -->
    <div class="cart-icon" id="cartIcon">
        <i class="fas fa-shopping-cart"></i>
        <div class="cart-badge" id="cartBadge">0</div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3>Processing Order...</h3>
            <p>Preparing for WhatsApp</p>
        </div>
    </div>


    <div class="container">
        <!-- Modern Header -->
        <div class="header">
            <div class="logo-container">
                <div class="logo">
                    <img src="images/beadsyde logo.jpg" alt="Beadsyde Logo">
                </div>
                <div class="brand-text">
                    <h1 class="brand-name">Beadsyde</h1>
                </div>
            </div>
        </div>

        <!-- Main Form -->
        <div class="form-section">
            <div class="section-header">
                <h2 class="section-title"><strong>Choose Your <span class="infinity-text">Infinity</span></strong></h2>
                <p class="section-subtitle">Premium Anti-Tarnish Stainless Steel ‚Ä¢ Waterproof with Love and Care</p>
            </div>

            <!-- Products -->
            <div class="products-container">
                <!-- Necklace -->
                <div class="product-group">
                    <h3 class="product-group-title">‚àû Infinity Necklace</h3>
                    <div class="product-variants">
                        <!-- Silver Necklace -->
                        <div class="product-card" data-product="necklace" data-variant="silver" data-price="499">
                            <div class="product-image-container">
                                <img src="images/silver necklace.png" alt="Infinity Necklace Silver" class="product-image">
                            </div>
                            <div class="product-info">
                                <h4 class="product-name">Silver Infinity Necklace</h4>
                                <div class="product-price">‚Çπ499</div>
                            </div>
                            <div class="cart-controls">
                                <div class="quantity-selector">
                                    <span class="quantity-label">Quantity:</span>
                                    <div class="quantity-controls">
                                        <button class="qty-btn minus-btn" data-product="necklace-silver">‚àí</button>
                                        <input type="number" class="qty-display" value="1" min="1" max="5" readonly data-product="necklace-silver">
                                        <button class="qty-btn plus-btn" data-product="necklace-silver">+</button>
                                    </div>
                                </div>
                                <button class="add-to-cart-btn" data-product="necklace-silver">
                                    <i class="fas fa-cart-plus"></i>
                                    Add to Cart
                                </button>
                                <button class="remove-from-cart-btn" data-product="necklace-silver" style="display: none;">
                                    <i class="fas fa-trash"></i>
                                    Remove from Cart
                                </button>
                            </div>
                        </div>

                        <!-- Gold Necklace -->
                        <div class="product-card" data-product="necklace" data-variant="gold" data-price="499">
                            <div class="product-image-container">
                                <img src="images/infinity necklace gold.jpg" alt="Infinity Necklace Gold" class="product-image">
                            </div>
                            <div class="product-info">
                                <h4 class="product-name">Golden Infinity Necklace</h4>
                                <div class="product-price">‚Çπ499</div>
                            </div>
                            <div class="cart-controls">
                                <div class="quantity-selector">
                                    <span class="quantity-label">Quantity:</span>
                                    <div class="quantity-controls">
                                        <button class="qty-btn minus-btn" data-product="necklace-gold">‚àí</button>
                                        <input type="number" class="qty-display" value="1" min="1" max="5" readonly data-product="necklace-gold">
                                        <button class="qty-btn plus-btn" data-product="necklace-gold">+</button>
                                    </div>
                                </div>
                                <button class="add-to-cart-btn" data-product="necklace-gold">
                                    <i class="fas fa-cart-plus"></i>
                                    Add to Cart
                                </button>
                                <button class="remove-from-cart-btn" data-product="necklace-gold" style="display: none;">
                                    <i class="fas fa-trash"></i>
                                    Remove from Cart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bracelet -->
                <div class="product-group">
                    <h3 class="product-group-title">‚àû Infinity Bracelet</h3>
                    <div class="product-variants">
                        <!-- Silver Bracelet -->
                        <div class="product-card" data-product="bracelet" data-variant="silver" data-price="349">
                            <div class="product-image-container">
                                <img src="images/infinity bracelet silver.jpg" alt="Infinity Bracelet Silver" class="product-image">
                            </div>
                            <div class="product-info">
                                <h4 class="product-name">Silver Infinity Bracelet</h4>
                                <div class="product-price">‚Çπ349</div>
                            </div>
                            <div class="cart-controls">
                                <div class="quantity-selector">
                                    <span class="quantity-label">Quantity:</span>
                                    <div class="quantity-controls">
                                        <button class="qty-btn minus-btn" data-product="bracelet-silver">‚àí</button>
                                        <input type="number" class="qty-display" value="1" min="1" max="5" readonly data-product="bracelet-silver">
                                        <button class="qty-btn plus-btn" data-product="bracelet-silver">+</button>
                                    </div>
                                </div>
                                <button class="add-to-cart-btn" data-product="bracelet-silver">
                                    <i class="fas fa-cart-plus"></i>
                                    Add to Cart
                                </button>
                                <button class="remove-from-cart-btn" data-product="bracelet-silver" style="display: none;">
                                    <i class="fas fa-trash"></i>
                                    Remove from Cart
                                </button>
                            </div>
                        </div>

                        <!-- Gold Bracelet -->
                        <div class="product-card" data-product="bracelet" data-variant="gold" data-price="349">
                            <div class="product-image-container">
                                <img src="images/infinity bracelet gold.jpg" alt="Infinity Bracelet Gold" class="product-image">
                            </div>
                            <div class="product-info">
                                <h4 class="product-name">Golden Infinity Bracelet</h4>
                                <div class="product-price">‚Çπ349</div>
                            </div>
                            <div class="cart-controls">
                                <div class="quantity-selector">
                                    <span class="quantity-label">Quantity:</span>
                                    <div class="quantity-controls">
                                        <button class="qty-btn minus-btn" data-product="bracelet-gold">‚àí</button>
                                        <input type="number" class="qty-display" value="1" min="1" max="5" readonly data-product="bracelet-gold">
                                        <button class="qty-btn plus-btn" data-product="bracelet-gold">+</button>
                                    </div>
                                </div>
                                <button class="add-to-cart-btn" data-product="bracelet-gold">
                                    <i class="fas fa-cart-plus"></i>
                                    Add to Cart
                                </button>
                                <button class="remove-from-cart-btn" data-product="bracelet-gold" style="display: none;">
                                    <i class="fas fa-trash"></i>
                                    Remove from Cart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Customer Details -->
        <div class="customer-details">
            <div class="section-header">
                <h2 class="section-title">Contact Details</h2>
                <p class="section-subtitle">We need this to deliver your infinity at your doorstep!</p>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="customerName">Full Name <span class="required">*</span></label>
                    <input type="text" id="customerName" required placeholder="Enter your full name">
                    <i class="fas fa-check validation-icon success"></i>
                    <i class="fas fa-times validation-icon error"></i>
                    <div class="error-message">Please enter your full name</div>
                </div>

                <div class="form-group">
                    <label for="customerPhone">Phone Number <span class="required">*</span></label>
                    <input type="tel" id="customerPhone" required placeholder="+91 9876543210">
                    <i class="fas fa-check validation-icon success"></i>
                    <i class="fas fa-times validation-icon error"></i>
                    <div class="error-message">Please enter a valid phone number</div>
                </div>
            </div>

            <!-- Address and Landmark Row -->
            <div class="form-row address-landmark-row">
                <div class="form-group address-group">
                    <label for="addressLine1">Address <span class="required">*</span></label>
                    <input type="text" id="addressLine1" required placeholder="House no., building, street, area">
                    <i class="fas fa-check validation-icon success"></i>
                    <i class="fas fa-times validation-icon error"></i>
                    <div class="error-message">Please provide your address</div>
                </div>

                <div class="form-group">
                    <label for="addressLandmark">Landmark (Optional)</label>
                    <input type="text" id="addressLandmark" placeholder="Near hospital, mall, etc.">
                    <i class="fas fa-check validation-icon success"></i>
                    <i class="fas fa-times validation-icon error"></i>
                </div>
            </div>

            <!-- City, State, PIN Row -->
            <div class="address-grid">
                <div class="form-group">
                    <label for="addressCity">City <span class="required">*</span></label>
                    <input type="text" id="addressCity" required placeholder="Your city">
                    <i class="fas fa-check validation-icon success"></i>
                    <i class="fas fa-times validation-icon error"></i>
                    <div class="error-message">Enter city</div>
                </div>

                <div class="form-group">
                    <label for="addressState">State <span class="required">*</span></label>
                    <div class="state-dropdown-container">
                        <input type="text" id="addressState" required placeholder="Type to search states..." autocomplete="off">
                        <div class="state-dropdown" id="stateDropdown"></div>
                    </div>
                    <i class="fas fa-check validation-icon success"></i>
                    <i class="fas fa-times validation-icon error"></i>
                    <div class="error-message">Select a valid Indian state</div>
                </div>

                <div class="form-group">
                    <label for="addressPincode">PIN Code <span class="required">*</span></label>
                    <input type="text" id="addressPincode" required placeholder="123456" maxlength="6">
                    <i class="fas fa-check validation-icon success"></i>
                    <i class="fas fa-times validation-icon error"></i>
                    <div class="error-message">6-digit PIN</div>
                </div>
            </div>

            <div class="form-row full-width">
                <div class="form-group">
                    <label for="specialNotes">üíï A Love Note From Your Heart <span class="subtitle">(Handwritten by Beadsyde with your order)</span></label>
                    <textarea id="specialNotes" rows="3" maxlength="100" placeholder="Write your heartfelt message... we'll handprint it beautifully for your beloved ‚ú®"></textarea>
                    <div class="character-counter">
                        <span id="charCount">0</span>/100 characters
                    </div>
                </div>
            </div>
        </div>

        <!-- Order Summary -->
        <div class="form-section">
            <div class="order-summary" id="orderSummary">
                <div class="summary-header">
                    <h3 class="summary-title">Your Cart</h3>
                </div>
                <div class="empty-cart" id="emptyCart">
                    <i class="fas fa-shopping-cart"></i>
                    <p>Your cart is empty. Add some beautiful jewelry!</p>
                </div>
                <div class="summary-items" id="summaryItems" style="display: none;">
                    <!-- Dynamic content -->
                </div>
                <div class="summary-totals" id="summaryTotals" style="display: none;">
                    <div class="total-row">
                        <span>Shipping</span>
                        <span>‚Çπ100</span>
                    </div>
                    <div class="total-row final">
                        <span>Total Amount</span>
                        <span id="totalAmount">‚Çπ100</span>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="submit-section">
                <button class="submit-btn" id="submitOrder" disabled>
                    <i class="fab fa-whatsapp"></i> Complete Order via WhatsApp
                </button>
                <p class="payment-info-text">üì± <strong>How it works:</strong> Click the button to send your order via WhatsApp. You'll receive payment details (UPI ID: khemkakshama64-1@oksbi) in the message. Pay the amount and share payment screenshot to confirm your order!</p>
            </div>

            <!-- Delivery Info -->
            <div class="delivery-info">
                <h4 class="delivery-title">Delivery Information</h4>
                <div class="delivery-details">
                    <div class="delivery-item">
                        <i class="fas fa-clock"></i>
                        <span>4-6 working days (India Only)</span>
                    </div>
                    <div class="delivery-item">
                        <i class="fas fa-credit-card"></i>
                        <span>Online payment only</span>
                    </div>
                    <div class="delivery-item">
                        <i class="fas fa-shield-alt"></i>
                        <span>Secure packaging</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <p><i class="fab fa-instagram"></i> Follow us: <a href="https://www.instagram.com/beadsyde/" target="_blank" class="footer-link">@beadsyde</a> | <i class="fab fa-whatsapp"></i> Join our <a href="https://chat.whatsapp.com/BTUOnwDzoLgBfCnrjNcL6j" target="_blank" class="footer-link">WhatsApp Community</a></p>
        </div>
    </div>

    <script>
        // =============================================
        // COMPREHENSIVE ANALYTICS TRACKING SYSTEM
        // =============================================

        class BeadsydeAnalytics {
            constructor() {
                this.sessionId = this.generateSessionId();
                this.pageLoadTime = Date.now();
                this.userId = this.getUserId();
                this.events = [];
                this.cartEvents = [];
                this.isTracking = true;
                this.firebaseReady = false;

                // Wait for Firebase to be ready
                this.waitForFirebase().then(() => {
                    this.firebaseReady = true;
                    console.log('üìä Analytics ready with Firebase');
                });

                this.init();
            }

            async waitForFirebase() {
                return new Promise((resolve) => {
                    const checkFirebase = () => {
                        if (window.firebaseDB) {
                            resolve();
                        } else {
                            setTimeout(checkFirebase, 100);
                        }
                    };
                    checkFirebase();
                });
            }

            init() {
                // Initialize Firebase
                this.initFirebase();

                // Track page view immediately
                this.trackPageView();

                // Set up event listeners
                this.setupEventTracking();

                // Track session duration
                this.trackSessionDuration();

                // Send events periodically
                setInterval(() => this.flushEvents(), 30000);

                // Track page exit
                window.addEventListener('beforeunload', () => this.trackPageExit());

                console.log('üî• Beadsyde Analytics initialized');
            }

            generateSessionId() {
                return 'sess_' + Date.now() + '_' + Math.random().toString(36).substring(2);
            }

            getUserId() {
                let userId = localStorage.getItem('beadsyde_user_id');
                if (!userId) {
                    userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substring(2);
                    localStorage.setItem('beadsyde_user_id', userId);
                }
                return userId;
            }

            initFirebase() {
                // Use the already initialized Firebase database
                this.database = window.firebaseDB;
                if (this.database) {
                    console.log('üî• Firebase database connected to analytics');
                } else {
                    console.warn('Firebase not available, using localStorage fallback');
                }
            }

            getDeviceInfo() {
                const ua = navigator.userAgent;
                let deviceType = 'desktop';

                if (/tablet|ipad|playbook|silk/i.test(ua)) {
                    deviceType = 'tablet';
                } else if (/mobile|iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/i.test(ua)) {
                    deviceType = 'mobile';
                }

                return {
                    deviceType,
                    browser: this.getBrowser(ua),
                    os: this.getOS(ua),
                    screenWidth: window.screen.width,
                    screenHeight: window.screen.height,
                    viewportWidth: window.innerWidth,
                    viewportHeight: window.innerHeight,
                    userAgent: ua,
                    language: navigator.language,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
                };
            }

            getBrowser(ua) {
                if (ua.includes('Chrome')) return 'Chrome';
                if (ua.includes('Firefox')) return 'Firefox';
                if (ua.includes('Safari')) return 'Safari';
                if (ua.includes('Edge')) return 'Edge';
                if (ua.includes('Opera')) return 'Opera';
                return 'Unknown';
            }

            getOS(ua) {
                if (ua.includes('Windows')) return 'Windows';
                if (ua.includes('Mac')) return 'macOS';
                if (ua.includes('Linux')) return 'Linux';
                if (ua.includes('Android')) return 'Android';
                if (ua.includes('iOS')) return 'iOS';
                return 'Unknown';
            }

            trackEvent(eventType, eventData = {}) {
                const event = {
                    eventType,
                    eventData,
                    sessionId: this.sessionId,
                    userId: this.userId,
                    timestamp: Date.now(),
                    url: window.location.href,
                    referrer: document.referrer,
                    deviceInfo: this.getDeviceInfo()
                };

                this.events.push(event);

                // Also send to Google Analytics
                if (typeof gtag !== 'undefined') {
                    gtag('event', eventType, eventData);
                }

                console.log('üìä Event tracked:', eventType, eventData);
            }

            trackPageView() {
                this.trackEvent('page_view', {
                    page_title: document.title,
                    page_location: window.location.href,
                    load_time: Date.now() - this.pageLoadTime
                });
            }

            trackProductView(productId, productName, price) {
                this.trackEvent('view_item', {
                    item_id: productId,
                    item_name: productName,
                    price: price,
                    currency: 'INR'
                });
            }

            trackAddToCart(productKey, productName, price, quantity, productData = {}) {
                const detailedEvent = {
                    item_id: productKey,
                    item_name: productName,
                    price: price,
                    quantity: quantity,
                    currency: 'INR',
                    product_variant: productData.variant || 'unknown',
                    product_type: productData.product || 'unknown',
                    product_image: productData.image || '',
                    total_value: price * quantity
                };

                this.trackEvent('add_to_cart', detailedEvent);

                this.cartEvents.push({
                    action: 'add_to_cart',
                    productKey,
                    productName,
                    price,
                    quantity,
                    variant: productData.variant,
                    productType: productData.product,
                    image: productData.image,
                    totalValue: price * quantity,
                    timestamp: Date.now()
                });

                console.log('üõí Cart Event Tracked:', {
                    product: productName,
                    variant: productData.variant,
                    quantity: quantity,
                    price: price
                });
            }

            trackRemoveFromCart(productId, productName) {
                this.trackEvent('remove_from_cart', {
                    item_id: productId,
                    item_name: productName
                });
            }

            trackPurchase(orderData) {
                this.trackEvent('purchase', {
                    transaction_id: orderData.orderId,
                    value: orderData.total,
                    currency: 'INR',
                    items: orderData.items.map(item => ({
                        item_id: item.id,
                        item_name: item.name,
                        price: item.price,
                        quantity: item.quantity
                    }))
                });

                // Save detailed order to database
                this.saveOrderToDatabase(orderData);
            }

            trackFormField(fieldName, fieldValue) {
                this.trackEvent('form_field_interaction', {
                    field_name: fieldName,
                    field_value: fieldValue ? 'filled' : 'empty',
                    has_value: !!fieldValue
                });
            }

            trackWhatsAppRedirect(orderData) {
                this.trackEvent('whatsapp_redirect', {
                    order_id: orderData.orderId,
                    total_amount: orderData.total,
                    items_count: orderData.items.length
                });

                // Save WhatsApp interaction
                this.saveWhatsAppMessage(orderData);
            }

            saveOrderToDatabase(orderData) {
                if (!this.database) return;

                const orderRef = this.database.ref('orders').push();
                orderRef.set({
                    ...orderData,
                    sessionId: this.sessionId,
                    userId: this.userId,
                    timestamp: Date.now(),
                    deviceInfo: this.getDeviceInfo()
                }).catch(error => console.error('Database save failed:', error));
            }

            saveWhatsAppMessage(orderData) {
                if (!this.database) return;

                const messageRef = this.database.ref('whatsapp_messages').push();
                messageRef.set({
                    orderId: orderData.orderId,
                    customerName: orderData.customer?.name,
                    customerPhone: orderData.customer?.phone,
                    totalAmount: orderData.total,
                    items: orderData.items,
                    sessionId: this.sessionId,
                    userId: this.userId,
                    timestamp: Date.now()
                }).catch(error => console.error('WhatsApp message save failed:', error));
            }

            trackSessionDuration() {
                setInterval(() => {
                    this.trackEvent('session_ping', {
                        duration: Date.now() - this.pageLoadTime
                    });
                }, 60000); // Every minute
            }

            trackPageExit() {
                const event = {
                    eventType: 'page_exit',
                    sessionId: this.sessionId,
                    userId: this.userId,
                    timestamp: Date.now(),
                    sessionDuration: Date.now() - this.pageLoadTime,
                    cartState: cart,
                    cartCount: cartCount
                };

                // Send immediately using beacon
                if (navigator.sendBeacon && this.database) {
                    const data = JSON.stringify(event);
                    navigator.sendBeacon('/api/analytics', data);
                }
            }

            setupEventTracking() {
                // Track all clicks
                document.addEventListener('click', (e) => {
                    this.trackEvent('click', {
                        element: e.target.tagName,
                        class: e.target.className,
                        id: e.target.id,
                        text: e.target.innerText?.substring(0, 50)
                    });
                });

                // Track scroll depth
                let maxScroll = 0;
                window.addEventListener('scroll', () => {
                    const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
                    if (scrollPercent > maxScroll) {
                        maxScroll = scrollPercent;
                        if (scrollPercent >= 25 && scrollPercent < 50) {
                            this.trackEvent('scroll_depth', { depth: '25%' });
                        } else if (scrollPercent >= 50 && scrollPercent < 75) {
                            this.trackEvent('scroll_depth', { depth: '50%' });
                        } else if (scrollPercent >= 75) {
                            this.trackEvent('scroll_depth', { depth: '75%' });
                        }
                    }
                });

                // Track contact form interactions
                const contactFields = [
                    'customerName', 'customerPhone', 'addressLine1',
                    'addressCity', 'addressState', 'addressPincode',
                    'addressLandmark', 'specialNotes'
                ];

                contactFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (field) {
                        field.addEventListener('input', () => {
                            this.trackFormFieldInteraction(fieldId, field.value);

                            // Track complete contact details when form is substantially filled
                            const contactData = this.getCurrentContactData();
                            if (this.calculateFormCompletion(contactData) >= 50) {
                                this.trackContactDetails(contactData);
                            }
                        });

                        field.addEventListener('focus', () => {
                            this.trackEvent('form_field_focus', {
                                field_id: fieldId,
                                field_type: this.getFieldType(fieldId)
                            });
                        });

                        field.addEventListener('blur', () => {
                            this.trackEvent('form_field_blur', {
                                field_id: fieldId,
                                field_value_length: field.value.length,
                                field_filled: field.value.length > 0,
                                field_type: this.getFieldType(fieldId)
                            });
                        });
                    }
                });
            }

            getCurrentContactData() {
                return {
                    name: document.getElementById('customerName')?.value || '',
                    phone: document.getElementById('customerPhone')?.value || '',
                    address: document.getElementById('addressLine1')?.value || '',
                    city: document.getElementById('addressCity')?.value || '',
                    state: document.getElementById('addressState')?.value || '',
                    pincode: document.getElementById('addressPincode')?.value || '',
                    landmark: document.getElementById('addressLandmark')?.value || '',
                    specialNotes: document.getElementById('specialNotes')?.value || ''
                };
            }

            async flushEvents() {
                if (this.events.length === 0) return;

                // Save to localStorage as fallback
                const localEvents = JSON.parse(localStorage.getItem('beadsyde_analytics') || '[]');
                localEvents.push(...this.events);
                localStorage.setItem('beadsyde_analytics', JSON.stringify(localEvents));

                // Save to Firebase if available
                if (this.database && this.firebaseReady) {
                    try {
                        // Import Firebase functions dynamically
                        const { ref, push } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js');

                        const eventsRef = ref(this.database, 'analytics_events');

                        // Push each event to Firebase
                        for (const event of this.events) {
                            await push(eventsRef, event);
                        }

                        console.log(`üî• Uploaded ${this.events.length} events to Firebase`);
                    } catch (error) {
                        console.warn('Failed to upload events to Firebase:', error);
                    }
                }

                console.log(`üì§ Processed ${this.events.length} events`);
                this.events = [];
            }

            trackFormFieldInteraction(fieldName, fieldValue) {
                this.trackEvent('form_field_interaction', {
                    field_name: fieldName,
                    field_filled: fieldValue.length > 0,
                    field_length: fieldValue.length,
                    field_type: this.getFieldType(fieldName)
                });
            }

            trackContactDetails(contactData) {
                this.trackEvent('contact_details_filled', {
                    has_name: !!contactData.name,
                    has_phone: !!contactData.phone,
                    has_address: !!contactData.address,
                    has_city: !!contactData.city,
                    has_state: !!contactData.state,
                    has_pincode: !!contactData.pincode,
                    has_landmark: !!contactData.landmark,
                    has_notes: !!contactData.specialNotes,
                    completion_percentage: this.calculateFormCompletion(contactData)
                });

                console.log('üìù Contact Details Tracked:', contactData);
            }

            getFieldType(fieldName) {
                const fieldTypes = {
                    customerName: 'name',
                    customerPhone: 'phone',
                    addressLine1: 'address',
                    addressCity: 'city',
                    addressState: 'state',
                    addressPincode: 'pincode',
                    addressLandmark: 'landmark',
                    specialNotes: 'notes'
                };
                return fieldTypes[fieldName] || 'unknown';
            }

            calculateFormCompletion(contactData) {
                const requiredFields = ['name', 'phone', 'address', 'city', 'state', 'pincode'];
                const filledFields = requiredFields.filter(field => contactData[field] && contactData[field].trim().length > 0);
                return Math.round((filledFields.length / requiredFields.length) * 100);
            }

            trackPurchase(orderData) {
                this.trackEvent('purchase', {
                    order_id: orderData.orderId,
                    customer_name: orderData.customerName,
                    customer_phone: orderData.customerPhone,
                    total_amount: orderData.totalAmount,
                    item_count: orderData.items.length,
                    items: orderData.items,
                    address: orderData.address,
                    currency: 'INR'
                });

                // Save complete order to cloud database
                this.saveOrderToCloud(orderData);
            }

            trackWhatsAppRedirect(orderData) {
                this.trackEvent('whatsapp_redirect', {
                    order_id: orderData.orderId,
                    customer_name: orderData.customerName,
                    customer_phone: orderData.customerPhone,
                    whatsapp_number: '918104563011',
                    message_sent: true
                });

                // Save WhatsApp interaction to cloud database
                this.saveWhatsAppInteraction(orderData);
            }

            async saveOrderToCloud(orderData) {
                // Save to localStorage first
                const orders = JSON.parse(localStorage.getItem('beadsyde_orders') || '[]');
                orders.push({
                    ...orderData,
                    timestamp: Date.now(),
                    deviceInfo: this.getDeviceInfo()
                });
                localStorage.setItem('beadsyde_orders', JSON.stringify(orders));

                // Save to Firebase if available
                if (this.database && this.firebaseReady) {
                    try {
                        const { ref, push } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js');
                        const ordersRef = ref(this.database, 'orders');

                        await push(ordersRef, {
                            ...orderData,
                            timestamp: Date.now(),
                            deviceInfo: this.getDeviceInfo(),
                            sessionId: this.sessionId,
                            userId: this.userId
                        });

                        console.log('üõí Order saved to cloud database');
                    } catch (error) {
                        console.warn('Failed to save order to Firebase:', error);
                    }
                }
            }

            async saveWhatsAppInteraction(orderData) {
                const interactionData = {
                    orderId: orderData.orderId,
                    customerName: orderData.customerName,
                    customerPhone: orderData.customerPhone,
                    whatsappNumber: '918104563011',
                    timestamp: Date.now(),
                    deviceInfo: this.getDeviceInfo(),
                    sessionId: this.sessionId,
                    userId: this.userId
                };

                // Save to localStorage
                const interactions = JSON.parse(localStorage.getItem('beadsyde_whatsapp_interactions') || '[]');
                interactions.push(interactionData);
                localStorage.setItem('beadsyde_whatsapp_interactions', JSON.stringify(interactions));

                // Save to Firebase if available
                if (this.database && this.firebaseReady) {
                    try {
                        const { ref, push } = await import('https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js');
                        const whatsappRef = ref(this.database, 'whatsapp_interactions');

                        await push(whatsappRef, interactionData);

                        console.log('üí¨ WhatsApp interaction saved to cloud database');
                    } catch (error) {
                        console.warn('Failed to save WhatsApp interaction to Firebase:', error);
                    }
                }
            }
        }

        // Initialize analytics
        window.analytics = new BeadsydeAnalytics();

        // =============================================
        // ORIGINAL BEADSYDE CODE
        // =============================================

        // Shopping cart state
        let cart = {};
        let cartCount = 0;

        // Track which fields user has interacted with
        let touchedFields = new Set();

        // Indian States Array
        const indianStates = [
            'Andhra Pradesh', 'Arunachal Pradesh', 'Assam', 'Bihar', 'Chhattisgarh',
            'Goa', 'Gujarat', 'Haryana', 'Himachal Pradesh', 'Jharkhand',
            'Karnataka', 'Kerala', 'Madhya Pradesh', 'Maharashtra', 'Manipur',
            'Meghalaya', 'Mizoram', 'Nagaland', 'Odisha', 'Punjab',
            'Rajasthan', 'Sikkim', 'Tamil Nadu', 'Telangana', 'Tripura',
            'Uttar Pradesh', 'Uttarakhand', 'West Bengal', 'Delhi'
        ];

        // Initialize state dropdown
        function initializeStateDropdown() {
            const stateInput = document.getElementById('addressState');
            const dropdown = document.getElementById('stateDropdown');

            stateInput.addEventListener('input', function() {
                const query = this.value.toLowerCase().trim();
                if (query.length === 0) {
                    dropdown.classList.remove('show');
                    return;
                }

                const filteredStates = indianStates.filter(state =>
                    state.toLowerCase().includes(query)
                );

                if (filteredStates.length > 0) {
                    dropdown.innerHTML = '';
                    filteredStates.forEach(state => {
                        const option = document.createElement('div');
                        option.className = 'state-option';
                        option.textContent = state;
                        option.addEventListener('click', function() {
                            stateInput.value = state;
                            dropdown.classList.remove('show');
                            // Trigger validation
                            validateState(stateInput);
                        });
                        dropdown.appendChild(option);
                    });
                    dropdown.classList.add('show');
                } else {
                    dropdown.classList.remove('show');
                }
            });

            // Hide dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!stateInput.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.classList.remove('show');
                }
            });
        }

        // Character counter functionality
        function setupCharacterCounter() {
            const specialNotesTextarea = document.getElementById('specialNotes');
            const charCountElement = document.getElementById('charCount');
            const counterElement = document.querySelector('.character-counter');

            if (specialNotesTextarea && charCountElement) {
                function updateCharacterCount() {
                    const currentLength = specialNotesTextarea.value.length;
                    const maxLength = 100;

                    charCountElement.textContent = currentLength;

                    // Remove existing classes
                    counterElement.classList.remove('warning', 'limit');

                    // Add appropriate class based on character count
                    if (currentLength >= maxLength) {
                        counterElement.classList.add('limit');
                    } else if (currentLength >= 80) {
                        counterElement.classList.add('warning');
                    }
                }

                // Update count on input
                specialNotesTextarea.addEventListener('input', updateCharacterCount);

                // Initialize counter
                updateCharacterCount();
            }
        }

        // Initialize form on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeForm();
        });

        function initializeForm() {
            setupCartHandlers();
            setupValidation();
            setupSubmission();
            setupCartIconClick();
            initializeStateDropdown();
            setupCharacterCounter();
            updateCartDisplay();
        }

        function setupCartIconClick() {
            const cartIcon = document.getElementById('cartIcon');
            if (cartIcon) {
                cartIcon.addEventListener('click', function() {
                    // Scroll to cart section
                    const cartSection = document.getElementById('orderSummary') || document.querySelector('.summary-container');
                    if (cartSection) {
                        cartSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            }
        }

        function setupCartHandlers() {
            // Quantity buttons
            document.querySelectorAll('.qty-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productKey = this.dataset.product;
                    const qtyDisplay = document.querySelector(`.qty-display[data-product="${productKey}"]`);
                    let currentQty = parseInt(qtyDisplay.value);

                    if (this.classList.contains('plus-btn')) {
                        if (currentQty < 5) {
                            currentQty++;
                            qtyDisplay.value = currentQty;
                        }
                    } else if (this.classList.contains('minus-btn')) {
                        if (currentQty > 1) {
                            currentQty--;
                            qtyDisplay.value = currentQty;
                        }
                    }

                    updateQuantityButtons(productKey);
                });
            });

            // Add to cart buttons
            document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productKey = this.dataset.product;
                    const productCard = this.closest('.product-card');
                    const quantity = parseInt(document.querySelector(`.qty-display[data-product="${productKey}"]`).value);

                    addToCart(productCard, productKey, quantity);
                });
            });

            // Remove from cart buttons
            document.querySelectorAll('.remove-from-cart-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productKey = this.dataset.product;
                    removeFromCart(productKey);
                });
            });
        }

        function updateQuantityButtons(productKey) {
            const qtyDisplay = document.querySelector(`.qty-display[data-product="${productKey}"]`);
            const minusBtn = document.querySelector(`.minus-btn[data-product="${productKey}"]`);
            const plusBtn = document.querySelector(`.plus-btn[data-product="${productKey}"]`);

            const currentQty = parseInt(qtyDisplay.value);

            minusBtn.disabled = currentQty <= 1;
            plusBtn.disabled = currentQty >= 5;
        }

        function addToCart(productCard, productKey, quantity) {
            const productInfo = {
                name: productCard.querySelector('.product-name').textContent,
                price: parseInt(productCard.dataset.price),
                variant: productCard.dataset.variant,
                product: productCard.dataset.product,
                quantity: quantity,
                image: productCard.querySelector('.product-image').src
            };

            cart[productKey] = productInfo;
            cartCount = Object.keys(cart).length;

            // Update UI
            const addBtn = productCard.querySelector('.add-to-cart-btn');
            const removeBtn = productCard.querySelector('.remove-from-cart-btn');

            addBtn.classList.add('added');
            addBtn.innerHTML = '<i class="fas fa-check"></i> Added to Cart';

            setTimeout(() => {
                addBtn.style.display = 'none';
                removeBtn.style.display = 'block';
            }, 1000);

            updateCartDisplay();

            // üìä ANALYTICS: Track add to cart with complete product data
            if (window.analytics) {
                window.analytics.trackAddToCart(
                    productKey,
                    productInfo.name,
                    productInfo.price,
                    quantity,
                    productInfo  // Pass complete product data
                );
            }

            // Update form validation to refresh CTA button
            validateForm();
        }

        function updateCartQuantity(productKey, change) {
            if (cart[productKey]) {
                cart[productKey].quantity += change;

                if (cart[productKey].quantity <= 0) {
                    delete cart[productKey];
                    cartCount = Object.keys(cart).length;
                } else {
                    // Update the main quantity display as well
                    const qtyDisplay = document.querySelector(`.qty-display[data-product="${productKey}"]`);
                    if (qtyDisplay) {
                        qtyDisplay.value = cart[productKey].quantity;
                    }
                }

                updateCartDisplay();
                updateQuantityButtons(productKey);
                // Update form validation to refresh CTA button
                validateForm();
            }
        }

        function removeFromCart(productKey) {
            delete cart[productKey];
            cartCount = Object.keys(cart).length;

            // Update UI
            const productCard = document.querySelector(`[data-product="${productKey.split('-')[0]}"][data-variant="${productKey.split('-')[1]}"]`);
            const addBtn = productCard.querySelector('.add-to-cart-btn');
            const removeBtn = productCard.querySelector('.remove-from-cart-btn');

            addBtn.style.display = 'block';
            addBtn.classList.remove('added');
            addBtn.innerHTML = '<i class="fas fa-cart-plus"></i> Add to Cart';
            removeBtn.style.display = 'none';

            // Reset quantity to 1
            const qtyDisplay = document.querySelector(`.qty-display[data-product="${productKey}"]`);
            qtyDisplay.value = 1;
            updateQuantityButtons(productKey);

            updateCartDisplay();

            // üìä ANALYTICS: Track remove from cart
            if (window.analytics) {
                window.analytics.trackRemoveFromCart(productKey, 'Unknown Product');
            }

            // Update form validation to refresh CTA button
            validateForm();
        }

        function updateCartDisplay() {
            const cartBadge = document.getElementById('cartBadge');
            const emptyCart = document.getElementById('emptyCart');
            const summaryItems = document.getElementById('summaryItems');
            const summaryTotals = document.getElementById('summaryTotals');
            const totalAmountElement = document.getElementById('totalAmount');

            cartBadge.textContent = cartCount;

            // Remove any existing shipping prompts
            const existingPrompt = document.querySelector('.shipping-prompt');
            if (existingPrompt) {
                existingPrompt.remove();
            }

            if (cartCount === 0) {
                emptyCart.style.display = 'block';
                summaryItems.style.display = 'none';
                summaryTotals.style.display = 'none';
            } else {
                emptyCart.style.display = 'none';
                summaryItems.style.display = 'block';
                summaryTotals.style.display = 'block';

                // Build cart items
                summaryItems.innerHTML = '';
                let itemsTotal = 0;
                let shippingCost = 100;

                Object.keys(cart).forEach(productKey => {
                    const item = cart[productKey];
                    const itemTotal = item.price * item.quantity;
                    itemsTotal += itemTotal;

                    const summaryItem = document.createElement('div');
                    summaryItem.className = 'summary-item';
                    summaryItem.innerHTML = `
                        <div class="item-details">
                            <img src="${item.image}" alt="${item.name}" class="item-image">
                            <div class="item-info">
                                <h4>${item.name}</h4>
                                <div class="cart-quantity-controls">
                                    <button class="cart-qty-btn" onclick="updateCartQuantity('${productKey}', -1)">-</button>
                                    <span class="cart-qty-display">${item.quantity}</span>
                                    <button class="cart-qty-btn" onclick="updateCartQuantity('${productKey}', 1)">+</button>
                                </div>
                            </div>
                        </div>
                        <div class="item-price-section">
                            <span class="item-price">‚Çπ${itemTotal}</span>
                            <button class="remove-item-btn" onclick="removeFromCart('${productKey}')">Remove</button>
                        </div>
                    `;
                    summaryItems.appendChild(summaryItem);
                });

                // Calculate shipping based on threshold
                if (itemsTotal >= 999) {
                    shippingCost = 0;
                }

                const total = itemsTotal + shippingCost;

                // Add shipping prompt if needed
                let shippingPrompt = '';
                if (itemsTotal < 999 && itemsTotal > 0) {
                    const needed = 999 - itemsTotal;
                    shippingPrompt = `<div class="shipping-prompt">Add ‚Çπ${needed} more for FREE shipping!</div>`;
                }

                // Update shipping display
                const shippingElement = document.querySelector('.total-row span:last-child');
                if (shippingElement) {
                    shippingElement.textContent = shippingCost === 0 ? 'FREE' : `‚Çπ${shippingCost}`;
                }

                // Add shipping prompt to summary
                if (shippingPrompt) {
                    summaryItems.insertAdjacentHTML('afterend', shippingPrompt);
                }

                totalAmountElement.textContent = `‚Çπ${total}`;
            }
        }

        function setupValidation() {
            const fields = {
                customerName: validateName,
                customerPhone: validatePhone,
                addressLine1: validateAddressLine1,
                addressCity: validateCity,
                addressState: validateState,
                addressPincode: validatePincode
            };

            Object.keys(fields).forEach(fieldId => {
                const field = document.getElementById(fieldId);

                // Mark field as touched when user interacts with it
                field.addEventListener('focus', function() {
                    touchedFields.add(fieldId);
                });

                // Only validate when user moves away from field (blur event)
                field.addEventListener('blur', function() {
                    touchedFields.add(fieldId);
                    fields[fieldId](this);
                    validateForm();
                });

                // Clear error state while typing
                field.addEventListener('input', function() {
                    if (this.value.trim() !== '') {
                        const formGroup = this.closest('.form-group');
                        formGroup.classList.remove('error');
                    }

                    // üìä ANALYTICS: Track form field interactions
                    if (window.analytics) {
                        window.analytics.trackFormField(this.id || this.name, this.value);
                    }
                });
            });

            // Initialize quantity buttons
            document.querySelectorAll('.qty-display').forEach(input => {
                updateQuantityButtons(input.dataset.product);
            });
        }

        function validateName(field) {
            const value = field.value.trim();
            const formGroup = field.closest('.form-group');
            const namePattern = /^[a-zA-Z\s]{3,}$/;
            const wordCount = value.split(' ').filter(word => word.length > 0).length;

            if (value && namePattern.test(value) && wordCount >= 2) {
                setFieldValid(formGroup);
                return true;
            } else {
                setFieldError(formGroup);
                return false;
            }
        }

        function validatePhone(field) {
            const value = field.value.trim();
            const formGroup = field.closest('.form-group');
            const phonePattern = /^(\+91[-\s]?)?[6-9]\d{9}$/;

            if (value && phonePattern.test(value.replace(/\s/g, ''))) {
                setFieldValid(formGroup);
                return true;
            } else {
                setFieldError(formGroup);
                return false;
            }
        }

        function validateAddressLine1(field) {
            const value = field.value.trim();
            const formGroup = field.closest('.form-group');

            if (value.length >= 10) {
                setFieldValid(formGroup);
                return true;
            } else {
                setFieldError(formGroup);
                return false;
            }
        }

        function validateCity(field) {
            const value = field.value.trim();
            const formGroup = field.closest('.form-group');
            const cityPattern = /^[a-zA-Z\s]{2,}$/;

            if (value && cityPattern.test(value)) {
                setFieldValid(formGroup);
                return true;
            } else {
                setFieldError(formGroup);
                return false;
            }
        }

        function validateState(field) {
            const value = field.value.trim();
            const formGroup = field.closest('.form-group');

            if (value && indianStates.includes(value)) {
                setFieldValid(formGroup);
                return true;
            } else {
                setFieldError(formGroup);
                return false;
            }
        }

        function validatePincode(field) {
            const value = field.value.trim();
            const formGroup = field.closest('.form-group');
            const pincodePattern = /^\d{6}$/;

            if (value && pincodePattern.test(value)) {
                setFieldValid(formGroup);
                return true;
            } else {
                setFieldError(formGroup);
                return false;
            }
        }

        function setFieldValid(formGroup) {
            formGroup.classList.remove('error');
            formGroup.classList.add('valid');
        }

        function setFieldError(formGroup) {
            formGroup.classList.add('error');
            formGroup.classList.remove('valid');
        }

        function validateForm() {
            const requiredFields = [
                'customerName', 'customerPhone', 'addressLine1',
                'addressCity', 'addressState', 'addressPincode'
            ];

            const validations = {
                customerName: validateName,
                customerPhone: validatePhone,
                addressLine1: validateAddressLine1,
                addressCity: validateCity,
                addressState: validateState,
                addressPincode: validatePincode
            };

            let allValid = true;
            let allFieldsFilled = true;

            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                const fieldValue = field.value.trim();

                // Check if field is empty
                if (!fieldValue) {
                    allFieldsFilled = false;
                }

                // Only validate fields that user has interacted with
                if (touchedFields.has(fieldId)) {
                    if (!validations[fieldId](field)) {
                        allValid = false;
                    }
                } else if (fieldValue) {
                    // If field has value but hasn't been touched, still validate it
                    if (!validations[fieldId](field)) {
                        allValid = false;
                    }
                }
            });

            const hasCartItems = cartCount > 0;
            const submitBtn = document.getElementById('submitOrder');

            // Always enable button and show "Place Order"
            submitBtn.disabled = false;

            if (allValid && hasCartItems && allFieldsFilled) {
                submitBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Place Order & Get Payment Link';
            } else {
                submitBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Place Order';
            }
        }

        function collectOrderData() {
            const selectedProducts = [];

            Object.keys(cart).forEach(productKey => {
                const item = cart[productKey];
                selectedProducts.push({
                    name: `Infinity ${item.product.charAt(0).toUpperCase() + item.product.slice(1)}`,
                    price: item.price,
                    quantity: item.quantity,
                    variant: item.variant.charAt(0).toUpperCase() + item.variant.slice(1),
                    total: item.price * item.quantity
                });
            });

            const customerData = {
                name: document.getElementById('customerName').value.trim(),
                phone: document.getElementById('customerPhone').value.trim(),
                address: {
                    line1: document.getElementById('addressLine1').value.trim(),
                    city: document.getElementById('addressCity').value.trim(),
                    state: document.getElementById('addressState').value.trim(),
                    pincode: document.getElementById('addressPincode').value.trim(),
                    landmark: document.getElementById('addressLandmark').value.trim()
                },
                specialNotes: document.getElementById('specialNotes').value.trim()
            };

            const landmarkText = customerData.address.landmark ? `, Near ${customerData.address.landmark}` : '';
            const fullAddress = `${customerData.address.line1}, ${customerData.address.city}, ${customerData.address.state} - ${customerData.address.pincode}${landmarkText}`;

            const itemsTotal = selectedProducts.reduce((sum, product) => sum + product.total, 0);
            const shippingCost = itemsTotal >= 999 ? 0 : 100;
            const total = itemsTotal + shippingCost;

            return {
                orderId: 'ORD-' + Date.now(),
                products: selectedProducts,
                items: selectedProducts,
                customer: customerData,
                customerName: customerData.name,
                customerPhone: customerData.phone,
                address: fullAddress,
                shipping: shippingCost,
                total: total,
                totalAmount: total,
                orderDate: new Date().toLocaleString('en-IN'),
                timestamp: Date.now()
            };
        }

        function generateWhatsAppMessage(orderData) {
            let message = `ü©µ NEW ORDER - BEADSYDE ü©µ

üóìÔ∏è ${orderData.orderDate}

Name: ${orderData.customer.name}
Phone: ${orderData.customer.phone}
Address: ${orderData.address}

`;
            orderData.products.forEach((product, index) => {
                message += `${index + 1}.‚Å† ‚Å†${product.name} (${product.variant}) x${product.quantity} = Rs.${product.total}

`;
            });

            message += `Items: Rs.${orderData.total - orderData.shipping}
Shipping: Rs.${orderData.shipping}
FINAL TOTAL: Rs.${orderData.total} ‚úÖ

üí¨NOTES:`;
            if (orderData.customer.specialNotes) {
                message += ` ${orderData.customer.specialNotes}`;
            }

            message += `

üöö Delivering Pan India in 4-6 working days

üí≥ Pay to: khemkakshama64-1@oksbi (Beadsyde)
Amount: Rs.${orderData.total}
Share payment screenshot to confirm your order!`;

            // For WhatsApp, we need to keep emojis as raw Unicode and only encode necessary characters
            return message
                .replace(/ /g, '%20')
                .replace(/\n/g, '%0A')
                .replace(/:/g, '%3A')
                .replace(/\|/g, '%7C')
                .replace(/\(/g, '%28')
                .replace(/\)/g, '%29')
                .replace(/-/g, '%2D');
        }

        async function logToGoogleSheets(orderData) {
            // Google Sheets integration disabled - using Firebase analytics instead
            console.log('üìä Order data saved to Firebase analytics:', orderData.orderId);
            return true;
        }

        function setupSubmission() {
            document.getElementById('submitOrder').addEventListener('click', async function() {
                const hasCartItems = cartCount > 0;
                const requiredFields = [
                    'customerName', 'customerPhone', 'addressLine1',
                    'addressCity', 'addressState', 'addressPincode'
                ];

                // Check if all fields are filled
                const allFieldsFilled = requiredFields.every(fieldId => {
                    return document.getElementById(fieldId).value.trim() !== '';
                });

                // If not ready to submit, handle scrolling and prompts
                if (!hasCartItems && !allFieldsFilled) {
                    // Both missing - scroll to products first
                    const productsSection = document.querySelector('.products-container');
                    if (productsSection) {
                        productsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        showPrompt('üõçÔ∏è First, please select the jewelry you want to order. Then fill in your contact details below.');
                    }
                    return;
                } else if (!hasCartItems) {
                    // Only products missing
                    const productsSection = document.querySelector('.products-container');
                    if (productsSection) {
                        productsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        showPrompt('üõçÔ∏è Please select some jewelry to add to your cart first!');
                    }
                    return;
                } else if (!allFieldsFilled) {
                    // Only contact details missing
                    const contactSection = document.querySelector('.customer-details');
                    if (contactSection) {
                        contactSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        showPrompt('üìù Please fill in your contact details so we can deliver your jewelry!');
                    }
                    return;
                }

                // If we reach here, proceed with order submission

                const loadingOverlay = document.getElementById('loadingOverlay');
                loadingOverlay.style.display = 'flex';

                try {
                    const orderData = collectOrderData();

                    // Log to Google Sheets
                    await logToGoogleSheets(orderData);

                    // üìä ANALYTICS: Track order completion and WhatsApp redirect
                    try {
                        if (window.analytics) {
                            window.analytics.trackPurchase(orderData);
                            window.analytics.trackWhatsAppRedirect(orderData);
                        }
                    } catch (analyticsError) {
                        console.warn('Analytics tracking failed:', analyticsError);
                        // Don't let analytics errors block the order
                    }

                    // Generate WhatsApp message with UPI link included
                    const whatsappMessage = generateWhatsAppMessage(orderData);
                    const whatsappNumber = '918104563011';
                    const whatsappUrl = `https://api.whatsapp.com/send/?phone=${whatsappNumber}&text=${whatsappMessage}`;

                    // Small delay for better UX
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                        // Direct redirect to WhatsApp with UPI link in message
                        window.location.href = whatsappUrl;
                    }, 1500);

                } catch (error) {
                    console.error('Error submitting order:', error);
                    loadingOverlay.style.display = 'none';
                    alert('There was an error processing your order. Please try again or contact us directly.');
                }
            });
        }



        function showPrompt(message) {
            // Create prompt element if it doesn't exist
            let promptElement = document.getElementById('userPrompt');
            if (!promptElement) {
                promptElement = document.createElement('div');
                promptElement.id = 'userPrompt';
                promptElement.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: #2E5BBA;
                    color: white;
                    padding: 15px 25px;
                    border-radius: 8px;
                    box-shadow: 0 4px 15px rgba(46, 91, 186, 0.3);
                    z-index: 10000;
                    font-weight: 500;
                    font-size: 14px;
                    max-width: 90%;
                    text-align: center;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                `;
                document.body.appendChild(promptElement);
            }

            promptElement.textContent = message;
            promptElement.style.opacity = '1';

            // Auto-hide after 4 seconds
            setTimeout(() => {
                promptElement.style.opacity = '0';
                setTimeout(() => {
                    if (promptElement.parentNode) {
                        promptElement.parentNode.removeChild(promptElement);
                    }
                }, 300);
            }, 4000);
        }

        function resetForm() {
            // Clear cart
            cart = {};
            cartCount = 0;

            // Reset all product UIs
            document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.style.display = 'block';
                btn.classList.remove('added');
                btn.innerHTML = '<i class="fas fa-cart-plus"></i> Add to Cart';
            });

            document.querySelectorAll('.remove-from-cart-btn').forEach(btn => {
                btn.style.display = 'none';
            });

            // Reset quantities
            document.querySelectorAll('.qty-display').forEach(input => {
                input.value = 1;
                updateQuantityButtons(input.dataset.product);
            });

            // Reset form fields
            const fieldIds = ['customerName', 'customerPhone', 'addressLine1', 'addressCity', 'addressState', 'addressPincode', 'addressLandmark', 'specialNotes'];
            fieldIds.forEach(fieldId => {
                document.getElementById(fieldId).value = '';
            });

            // Reset form groups
            document.querySelectorAll('.form-group').forEach(group => {
                group.classList.remove('error', 'valid');
            });

            // Clear touched fields
            touchedFields.clear();

            updateCartDisplay();
            validateForm();
        }
    </script>
</body>
</html>